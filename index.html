<html><head>
    <meta charset="utf-8">
    <title>Services and Access Map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script>

<!--    <link href="https://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" rel="stylesheet">-->
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css">
    <script src="Sources/leaflet-src.js"></script>
    <link href="Styles/MarkerCluster.css" rel="stylesheet">
    <link href="Styles/MarkerCluster.Default.css" rel="stylesheet">
    <script src="Sources/leaflet.markercluster-src.js"></script>
    <style>
        body {
            margin: 0px;
            padding: 0;
            background: #DDDC70;
            height: 20px;
            font-family: Lato, sans-serif;
            color: black;
        }

        header {
            padding: 6px 10%;
        }

        h1 {
            display: inline-block;
            margin-right: 20px;
            line-height: 3px;
            color: #001323;
        }

        h2 {
            /*            display: inline-block;*/
            line-height: 2px;
            color: #001323;
        }

        #map {
            width: 85%;
            height: 580px;
            border: 3px solid black;
            margin: 15px auto;
        }

        footer {
            padding: 6px 10%;
            width: 80%;
        }

        p {
            font-size: 1.2em;
            color: black;
            font-family: Lato, sans-serif;
        }

        /* Additional style rules go here! */

        .popup {
            background: green;
            color: green;
        }

        .author-info {
            text-align: right;
            font-style: italic;
        }
    </style>
</head>

<body>
    <header>
        <h1>Getting to and from in Metro Chicagoland</h1>

        <h2>Transportation options in relation to key neighborhood locations and services</h2>

        <p>This interactive map shows a sample of locations of common daily services in the city of Chicago and outlying areas in relation to common transportation options.</p>


    </header>

    <div id="map"></div>

    <footer>
        <p class="author-info"><b>Map created by Tom Scholten</b></p>

        <p><b>User Instructions:</b> click in an area of the map boundary. Then click on a service to discover the time associated with traveling to that service on foot, via bicycle, or automobile. Double click the map to show an illustration of the area that falls within a ten minute walking distance. Refresh the browser to start over.
        </p>

        <p>Access to transportation is a necessary element of modern life to obtain goods, services, and education as well as to gain employment, seek medical care, and enjoy cultural and recreational opportunities. The goal of this map is to show multiple data layers throughout the greater Chicago metropolitan area that paint a picture of existing transportation options in relation to key social institutions such as hospitals, schools, grocery stores as well areas that may be underserved by public/mass transit transportation.</p>

        <p>Stimulates Economic Development:</p>
        <ul>
            <li>Every $10 million in capital investment in public transportation yields $30 million in increased sales.</li>
            <li>Every $10 million in operating investment in public transportation yields $32 Million in increased sales.</li>
            <li>For every $10 million invested in capital projects for public transportation, more than 300 jobs are realized.</li>
        </ul>

        <p><b>Saves Money.</b> According to the American Automobile Association, the estimated cost of driving a single-occupant vehicle is between $4,826 (for a small car) and $9,685 (for a large car), depending upon mileage. By contrast, the annual average cost for public transportation for one adult ranges from $200 to $2,000, depending upon mileage, time of day, type of service.
        </p>
        <p><b>Improves Air.</b> Quality Each year, public transportation use avoids the emission of more than 126 million pounds of hydrocarbons, a primary cause of smog, and 156 million pounds of nitrogen oxides, which can cause respiratory disease.
        </p>
        <p><b>Enhanced Quality of Life. </b>Public transportation facilities and corridors are natural focal points for economic and social activities. These activities help create strong neighborhood centers that are more economically stable.
        </p>


        <p>While transit clearly benefits those who use it, even larger benefits spread to all citizens in the form of economic development, reduced congestion, cleaner air, and enhanced quality of life. According to AAA, the average annual cost of maintaining a small sedan is $6957, or $19.33 per day. Via bicycling.com, the cost of maintaining a bicycle is $300 a year, or 82 cents per day. Purchasing a monthly CTA/Pace train and bus pass averages to approximately $3.50 a day. As such, assuming a 25mph city driving speed, access to a car cost 24 times that of a bike and reduces travel time by almost two-thirds. Buses provide longer distance access but on fixed routes and times. As for walking, almost $20 per day reduces a 3 mile trip from an hour to 7 minutes. If you can afford it.
        </p>
        <ul>
            <p>Sources:</p>
            <li><a href="https://www.apta.com/mediacenter/ptbenefits/Pages/default.aspx">American Public Transportation Association</a></li>
            <li><a href="https://www.nationalexpresstransit.com/blog/9-benefits-of-public-transportation">9 Benefits of Public Transportation</a></li>
            <li><a href="https://www.apta.com/resources/aboutpt/pages/transitcalculator.aspx">Public Transportation Calculator</a></li>
            <li><a href="https://www.html.am/html-codes/links/">hyperlink</a></li>
        </ul>

    </footer>

    <!--    load geoJSON files used in this project-->
    <script src="Data/Hospitals.js"></script>
    <script src="Data/Pharmacies.js"></script>
    <script src="Data/Schools.js"></script>
    <script src="Data/Services_3.js"></script>
    <script src="Data/Stops_2.js"></script>
    <script src="Data/Trains.js"></script>

    <script>
        var markers;
        //        set map options to center map in the area of the Chicago metro area
        var options = {
            center: [41.834107, -87.957809],
            zoom: 9,
            doubleClickZoom: false,
            dragging: true,
            scrollWheelZoom: true,
        }
        //        define map variable and connect it to div space in html code above
        var map = L.map('map', options);

        //        define tile layer used in this map
        var tiles = L.tileLayer('https://{s}.{base}.maps.cit.api.here.com/maptile/2.1/{type}/{mapID}/normal.day/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}', {
            attribution: 'Map &copy; 1987-2014 <a href="https://developer.here.com">HERE</a>',
            subdomains: '1234',
            mapID: 'newest',
            app_id: '4YK8GRpcnECOf3a1wDa6',
            app_code: 'ae72xkEACul_-rqG8DsX6A',
            base: 'base',
            maxZoom: 20,
            type: 'maptile',
            language: 'eng',
            format: 'png8',
            size: '256'
        });
        map.addLayer(tiles);

        var MarkerIcon = L.Icon.extend({
            options: {
                iconSize: [25.6, 38.3],
                iconAnchor: [11.5, 19]
            }
        });

        var busIcon = new MarkerIcon({
            iconUrl: 'Icons/bus_stop.png'
        });
        var marketIcon = new MarkerIcon({
            iconUrl: 'Icons/market.png'
        });
        var hospitalIcon = new MarkerIcon({
            iconUrl: 'Icons/hospital.png'
        });
        var schoolIcon = new MarkerIcon({
            iconUrl: 'Icons/school.png'
        });
        var childcareIcon = new MarkerIcon({
            iconUrl: 'Icons/childcare.png'
        });
        var pharmacyIcon = new MarkerIcon({
            iconUrl: 'Icons/pharmacy.png'
        });
        var trainIcon = new MarkerIcon({
            iconUrl: 'Icons/train.png'
        });
        var marketSelectIcon = new MarkerIcon({
            iconUrl: 'Icons/market_yellow.png'
        });
        var hospitalSelectIcon = new MarkerIcon({
            iconUrl: 'Icons/hospital_yellow.png'
        });
        var schoolSelectIcon = new MarkerIcon({
            iconUrl: 'Icons/school_yellow.png'
        });
        var childcareSelectIcon = new MarkerIcon({
            iconUrl: 'Icons/childcare_yellow.png'
        });
        var pharmacySelectIcon = new MarkerIcon({
            iconUrl: 'Icons/pharmacy_yellow.png'
        });
        var trainSelectIcon = new MarkerIcon({
            iconUrl: 'Icons/train_yellow.png'
        });

        var markersCluster_hospital = L.markerClusterGroup();
        var markersCluster_pharmacy = L.markerClusterGroup();
        var markersCluster_market = L.markerClusterGroup();
        var markersCluster_childcare = L.markerClusterGroup();
        var markersCluster_stops = L.markerClusterGroup();
        var markersCluster_schools = L.markerClusterGroup();
        var markersCluster_trains = L.markerClusterGroup();

        //map.fitBounds(markersCluster.getBounds()); //set view on the cluster extend	

        //        locate HOSPITALS objects in Hospitals.js geoJSON, add them to map, with popup info available
        var hospital = L.geoJson(hospitals, {
            pointToLayer: function(feature, latlng) {
                var hMarker = L.marker([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], {
                    icon: hospitalIcon
                });
                hMarker.on('mouseover', function(e) {
                    hMarker.setIcon(hospitalSelectIcon);
                });
                hMarker.on('mouseout', function(e) {
                    hMarker.setIcon(hospitalIcon);
                });
                return hMarker
            },
            filter: function(feature, layer) {
                if (feature.properties.Service_Type == "HOSPITAL") {
                    return feature;
                }
            },
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>" + props.LABEL + "</b></br>" + props.ADDRESS;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_hospital);
        map.addLayer(markersCluster_hospital);

        //        locate PHARMACIES objects in Pharmacy.js geoJSON, add them to map, with popup info available
        var pharmacy = L.geoJson(pharmacies, {
            pointToLayer: function(feature, latlng) {
                var hMarker = L.marker([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], {
                    icon: pharmacyIcon
                });
                hMarker.on('mouseover', function(e) {
                    hMarker.setIcon(pharmacySelectIcon);
                });
                hMarker.on('mouseout', function(e) {
                    hMarker.setIcon(pharmacyIcon);
                });

                return hMarker
            },
            filter: function(feature, layer) {
                if (feature.properties.Service_Type == "Pharmacy") {
                    return feature;
                }
            },
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>" + props.NAME + "</b></br>" + props.ADDRESS;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_pharmacy);
        map.addLayer(markersCluster_pharmacy);

        //        locate MARKETS_GROCERY objects in services_3 geoJSON, add them to map, with popup info available
        var market = L.geoJson(services, {
            pointToLayer: function(feature, latlng) {
                var mMarker = L.marker([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], {
                    icon: marketIcon
                });
                mMarker.on('mouseover', function(e) {
                    mMarker.setIcon(marketSelectIcon);
                });
                mMarker.on('mouseout', function(e) {
                    mMarker.setIcon(marketIcon);
                });
                return mMarker
            },
            filter: function(feature, layer) {
                if (feature.properties.service_type == "Market") {
                    return feature;
                }
            },
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>" + props.service_name + "</b></br>" + props.address;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_market);
        map.addLayer(markersCluster_market);


        //        locate SCHOOL objects in Schools.js geoJSON, add them to map, with popup info available
        var school = L.geoJson(schools, {
            pointToLayer: function(feature, latlng) {


                var hMarker = L.marker([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], {
                    icon: schoolIcon
                });
                hMarker.on('mouseover', function(e) {
                    hMarker.setIcon(schoolSelectIcon);
                });
                hMarker.on('mouseout', function(e) {
                    hMarker.setIcon(schoolIcon);
                });
                return hMarker
            },
            filter: function(feature, layer) {
                if (feature.properties.service_type == "school") {
                    return feature;
                }
            },
            onEachFeature: function(feature, layer) {

                var props = feature.properties;
                var content = "<b>" + props.NAME + "</b></br>" + props.ADDRESS;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_schools);
        map.addLayer(markersCluster_schools);

        //        locate childcare objects in services_3 geoJSON, add them to map, with popup info available        
        var childcare = L.geoJson(services, {
            pointToLayer: function(feature, latlng) {
                var cMarker = L.marker([feature.geometry.coordinates[1], feature.geometry.coordinates[0]], {
                    icon: childcareIcon
                });
                cMarker.on('mouseover', function(e) {
                    cMarker.setIcon(childcareSelectIcon);
                });
                cMarker.on('mouseout', function(e) {
                    cMarker.setIcon(childcareIcon);
                });
                return cMarker
            },
            filter: function(feature, layer) {
                if (feature.properties.service_type == "Childcare") {
                    return feature;
                }
            },
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>" + props.service_name + "</b></br>" + props.address;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_childcare);
        map.addLayer(markersCluster_childcare);


        //        locate bus stop objects in Stops_2 geoJSON, add them to map, with popup info available        
        var stop = L.geoJson(stops, {
            pointToLayer: function(feature, latlng) {
                return L.circleMarker(latlng, {
                    color: '#2792c1',
                    weight: 4,
                    fillColor: '#2792c1',
                    fillOpacity: 0.5,
                    radius: 5
                });
            },
            //            filter by geometry type within Stops_2 geoJSON            
            filter: function(feature, layer) {
                if (feature.geometry.type == "Point") {
                    return feature;
                }
            },
            //            create popup feature for site information with user affordance in contrasting color            
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>Bus Stop # " + props.Bus_Stop_ID + "</b></br>" + props.Bus_Stop_Name;
                layer.bindPopup(content);
                layer.on('mouseover', function() {
                    layer.setStyle({
                        fillColor: 'yellow',
                        color: 'yellow'
                    });
                });
                layer.on('mouseout', function() {
                    layer.setStyle({
                        fillColor: '#2792c1',
                        color: '#2792c1'
                    });
                });
            }
        }).addTo(markersCluster_stops);
        map.addLayer(markersCluster_stops);


        //        locate childcare objects in services_3 geoJSON, add them to map, with popup info available        
        var train = L.geoJson(trains, {
            pointToLayer: function(feature, latlng) {
                var cMarker = L.marker([feature.geometry.coordinates[0][0][1], feature.geometry.coordinates[0][0][0]], {
                    icon: trainIcon
                });
                cMarker.on('mouseover', function(e) {
                    cMarker.setIcon(trainSelectIcon);
                });
                cMarker.on('mouseout', function(e) {
                    cMarker.setIcon(trainIcon);
                });
                return cMarker
            },
            filter: function(feature, layer) {
                //if (feature.properties.service_type == "Childcare") {
                return feature;
                //}
            },
            onEachFeature: function(feature, layer) {
                var props = feature.properties;
                var content = "<b>" + props.service_name + "</b></br>" + props.address;
                layer.bindPopup(content);
            }
        }).addTo(markersCluster_trains);
        map.addLayer(markersCluster_trains);


        map.on('click', function(e) {
            hospital.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var hospitalName = layer.feature.properties.LABEL;
                var hospitalAddress = layer.feature.properties.ADDRESS;
                var content = "<b>" + hospitalName + ":</b><br>" + hospitalAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike, and</br>" +
                    "<b>" + carTime.toLocaleString() + "</b> min by car at 25 mph"

                layer.bindPopup(content);

            });
        });

        //        calculator for distance (in miles) and time (in minutes) to service with popup showing those values
        map.on('click', function(e) {
            market.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var marketName = layer.feature.properties.service_name;
                var marketAddress = layer.feature.properties.address;
                var content = "<b>" + marketName + ":</b><br>" + marketAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike, and</br>" +
                    "<b>" + carTime.toLocaleString() + "</b> min by car at 25 mph"
                layer.bindPopup(content);

            });
        });

        //        calculator for distance (in miles) and time (in minutes) to service with popup showing those values        
        map.on('click', function(e) {
            pharmacy.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var pharmacyName = layer.feature.properties.NAME;
                var pharmacyAddress = layer.feature.properties.ADDRESS;
                var content = "<b>" + pharmacyName + ":</b><br>" + pharmacyAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike, and</br>" +
                    "<b>" + carTime.toLocaleString() + "</b> min by car at 25 mph"

                layer.bindPopup(content);

            });
        });


        map.on('click', function(e) {
            school.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var schoolName = layer.feature.properties.NAME;
                var schoolAddress = layer.feature.properties.ADDRESS;
                var content = "<b>" + schoolName + ":</b><br>" + schoolAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike, and</br>" +
                    "<b>" + carTime.toLocaleString() + "</b> min by car at 25 mph"

                layer.bindPopup(content);

            });
        });


        //        calculator for distance (in miles) and time (in minutes) to service with popup showing those values        
        map.on('click', function(e) {
            childcare.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var childcareName = layer.feature.properties.service_name;
                var childcareAddress = layer.feature.properties.address;
                var content = "<b>" + childcareName + ":</b><br>" + childcareAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike, and</br>" +
                    "<b>" + carTime.toLocaleString() + "</b> min by car at 25 mph"

                layer.bindPopup(content);

            });
        });

        //        calculator for distance (in miles) and time (in minutes) to service with popup showing those values        
        map.on('click', function(e) {
            stop.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var stopsName = layer.feature.properties.Bus_Stop_ID;
                var stopsAddress = layer.feature.properties.Bus_Stop_Name;
                var content = "<b>Bus Stop # " + stopsName + ":</b><br>" + stopsAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike,</br>" +
                    "plus the time for the bus to reach its destination!"

                layer.bindPopup(content);

            });
        });

        /*
		        //        calculator for distance (in miles) and time (in minutes) to service with popup showing those values        
        map.on('click', function(e) {
            train.eachLayer(function(layer) {
                var distance = e.latlng.distanceTo(layer.getLatLng()) * (0.000621371);

                var walkTime = distance / (3.1 / 60);
                var bikeTime = distance / (9.0 / 60);
                var carTime = distance / (25 / 60);

                var trainName = layer.feature.properties.BRANCH;
                var trainAddress = layer.feature.properties.DESCRIPTIO;
                var content = "<b>Bus Stop # " + trainName + ":</b><br>" + trainAddress + "<br>" +
                    "You are <b>" + distance.toLocaleString() +
                    "miles</b> from the click point.</br>" +
                    "This trip would take</br>" +
                    "<b>" + walkTime.toLocaleString() + "</b> min on foot</br>" +
                    "<b>" + bikeTime.toLocaleString() + "</b> min by bike,</br>" +
                    "plus the time for the bus to reach its destination!"

                layer.bindPopup(content);

            });
        });
		*/

        //        create legend with layers that can be turned on and off in common color schemes to the geoJSON objects
        var sourcesLayers = {
            "<b style='color:red'>Hospitals</b>": markersCluster_hospital,
            "<b style='color:gray'>Pharmacies</b>": markersCluster_pharmacy,
            "<b style='color:purple'>Groceries</b>": markersCluster_market,
            "<b style='color:green'>Schools</b>": markersCluster_schools,
            "<b style='color:orange'>Childcare</b>": markersCluster_childcare,
            "<b style='color:#2792c1'>Bus Stops</b>": markersCluster_stops,
            "<b style='color:yellow'>Train Stops</b>": markersCluster_trains
        }
        L.control.layers(null, sourcesLayers, {
            collapsed: false
        }).addTo(map);

        //        create marker for user when clicking on single point in map, will be used for distance calcs above
        var marker;
        var walkCircle;

        // when the user clicks on the map
        map.on('click', function(e) {
            // if the marker exists and is defined
            if (map.hasLayer(marker)) {
                // remove it from the map
                map.removeLayer(marker);
            }

            // store the click coordinates in a variable
            var clickCoords = e.latlng;

            // create a marker using those coods, 
            // add it to the map and assign it
            // to the existing variable marker
            marker = L.marker(clickCoords).addTo(map);

            // call the function and pass the marker's coords
            //            testDistance(clickCoords);
        });
        map.on('dblclick', function(e) {
            if (map.hasLayer(walkCircle)) {
                map.removeLayer(walkCircle);
            }
            var click = e.latlng;
            walkCircle = L.circle(click, 831.5, {
                stroke: false,
                fillColor: '#ffec00'
            }).addTo(map);
        });
    </script>
</body>
</html>